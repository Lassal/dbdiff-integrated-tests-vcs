schema: CLC
name: TBCLCW_CRDE_CLNT_PDV_RPLC
updatedAllowed: true
insertAllowed: true
viewDefinition: |-
  SELECT
    /*+ USE_NL(CLNT,CRCL,PDV,DMBN) */
    CICL.DT_PCSM_ATUL AS DT_RFRN_MVMN,
    BNDR.NM_BNDR AS NM_BNDR,
    CRDE.CD_BNDR AS CD_BNDR,
    CRDE.CD_CRDE AS CD_CRDE,
    CRDE.NM_RZSC_CRDE AS NM_RAZO_SOCL_CRDE,
    CRDE.NM_FNTS_CRDE AS NM_FNTS_CRDE,
    CLNT.SG_TPPS AS SG_TPPS_CLNT,
    CLNT.NU_CLNT AS NU_CLNT,
    CLNT.NM_CLNT AS NM_CLNT,
    CLNT.NU_RAIZ_CNPJ_CLNT AS NU_RAIZ_CNPJ_CLNT,
    CLNT.NU_FILI_CNPJ_CLNT AS NU_FILI_CNPJ_CLNT,
    CLNT.NU_DV_CNPJ_CLNT AS NU_DV_CNPJ_CLNT,
    CLNT.NU_CPF_CLNT AS NU_CPF_CLNT,
    CLNT.NU_DV_CPF_CLNT AS NU_DV_CPF_CLNT,
    TPPS.NM_TPPS AS NM_TPPS_CLNT,
    PDV.CD_PDV AS CD_PDV,
    PDV.IN_TRNS_FINC AS IN_TRNS_FINC,
    DMBN.CD_TIPO_PLTF_PGMN AS CD_TIPO_PLTF_PGMN,
    CLNT.SG_TPPS AS SG_TPPS_CRDE,
    TPPS.NM_TPPS AS NM_TPPS_CRDE
  FROM
    CCR.TBCCRR_CLNT CLNT,
    CCR.TBCCRR_CRDE_BNDR_CLNT CRCL,
    CCR.TBCCRR_PDV PDV,
    CCR.TBCCRR_DMBN_PDV_CNCR DMBN,
    CCR.TBCCRR_BNDR BNDR,
    CCR.TBCCRR_CRDE_BNDR CRDE,
    CCR.TBCCRR_TPPS TPPS,
    ccr.tbccrr_cicl_pcsm_cdst CICL
  WHERE
    DMBN.CD_BNDR = CRDE.CD_BNDR
    AND DMBN.CD_CRDE = CRDE.CD_CRDE
    AND DMBN.NU_CLNT = CRCL.NU_CLNT
    AND DMBN.CD_PDV = PDV.CD_PDV
    AND PDV.CD_BNDR = CRDE.CD_BNDR
    AND PDV.CD_CRDE = CRDE.CD_CRDE
    AND PDV.NU_CLNT = CRCL.NU_CLNT
    AND CRCL.NU_CLNT = CLNT.NU_CLNT
    AND TPPS.SG_TPPS = CLNT.SG_TPPS
    AND CRDE.CD_BNDR = CRCL.CD_BNDR
    AND CRDE.CD_CRDE = CRCL.CD_CRDE
    and CRDE.CD_BNDR = BNDR.CD_BNDR
    and CICL.IN_RGST_ATVO = 'S'
columns: []
referencedTables: []
