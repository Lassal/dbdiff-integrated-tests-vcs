schema: CLC
name: PRCLC_MVMC_LNCM_PNDT_RECB0406
routineType: PROCEDURE
returnParamater: null
parameters:
- name: V_CD_BNDR
  ordinalPosition: 1
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_CRDE
  ordinalPosition: 2
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_TIPO_PLTF_PGMN
  ordinalPosition: 3
  dataType: VARCHAR2
  parameterMode: IN
- name: V_NU_RMSA_CRDE
  ordinalPosition: 4
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_USRO_INCL_RGST
  ordinalPosition: 5
  dataType: VARCHAR2
  parameterMode: IN
- name: V_DH_INCL_RGST
  ordinalPosition: 6
  dataType: DATE
  parameterMode: IN
- name: V_TX_QNTD_DIA_LQDC_CRDE_BNDR
  ordinalPosition: 7
  dataType: VARCHAR2
  parameterMode: IN
- name: V_SG_ORGM_IFMC_RECB
  ordinalPosition: 8
  dataType: CHAR
  parameterMode: IN
- name: V_QT_DIA_LQDC_BNDR_EMSR
  ordinalPosition: 9
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_ERRO_PCSM_LQDC_RECB
  ordinalPosition: 10
  dataType: VARCHAR2
  parameterMode: IN
- name: V_CD_TIPO_MVMC_PARC
  ordinalPosition: 11
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_TIPO_STCO_PCSM
  ordinalPosition: 12
  dataType: VARCHAR2
  parameterMode: IN
- name: V_IN_ENVO_ANLT_CRDE_BNDR_EMSR
  ordinalPosition: 13
  dataType: CHAR
  parameterMode: IN
- name: V_IN_AUTC_SGRN
  ordinalPosition: 14
  dataType: CHAR
  parameterMode: IN
- name: V_QT_DIA_PDRO_LQDC_EMSR
  ordinalPosition: 15
  dataType: NUMBER
  parameterMode: IN
- name: V_QT_DIA_PDRO_PGMN_PDV
  ordinalPosition: 16
  dataType: NUMBER
  parameterMode: IN
- name: V_CD_BUSINESS_PROCESS
  ordinalPosition: 17
  dataType: NUMBER
  parameterMode: IN
- name: V_COMMIT_INTERVAL
  ordinalPosition: 18
  dataType: NUMBER
  parameterMode: IN
- name: V_RET
  ordinalPosition: 19
  dataType: NUMBER
  parameterMode: OUT
routineDefinition: |-
  PROCEDURE PRCLC_MVMC_LNCM_PNDT_RECB0406 (
    V_CD_BNDR IN NUMBER,
    V_CD_CRDE IN NUMBER,
    V_CD_TIPO_PLTF_PGMN IN VARCHAR2,
    V_NU_RMSA_CRDE IN NUMBER,
    V_CD_USRO_INCL_RGST IN VARCHAR2,
    V_DH_INCL_RGST IN DATE,
    V_TX_QNTD_DIA_LQDC_CRDE_BNDR IN VARCHAR2,
    V_SG_ORGM_IFMC_RECB IN CHAR,
    V_QT_DIA_LQDC_BNDR_EMSR IN NUMBER,
    V_CD_ERRO_PCSM_LQDC_RECB IN VARCHAR2,
    V_CD_TIPO_MVMC_PARC IN NUMBER,
    V_CD_TIPO_STCO_PCSM IN VARCHAR2,
    V_IN_ENVO_ANLT_CRDE_BNDR_EMSR IN CHAR,
    V_IN_AUTC_SGRN IN CHAR,
    V_QT_DIA_PDRO_LQDC_EMSR IN NUMBER,
    V_QT_DIA_PDRO_PGMN_PDV IN NUMBER,
    V_CD_BUSINESS_PROCESS IN NUMBER,
    V_COMMIT_INTERVAL IN NUMBER,
    V_RET OUT NUMBER
  ) AS --VARIAVEIS LOCAIS
  V_NU_SQNL TBCLCR_LNCM_RECB.NU_SQNL % TYPE;
  V_DT_RFRN_MVMN TBCLCR_LNCM_RECB.DT_RFRN_MVMN % TYPE;
  V_YY_INICIO CNTRPCSM.TBSHRR_HOLIDAY.YY_HOLIDAY % TYPE;
  V_YY_FINAL CNTRPCSM.TBSHRR_HOLIDAY.YY_HOLIDAY % TYPE;
  V_DT_LQDC_BNDR_CRDE TBCLCR_LNCM_RECB.DT_LQDC_BNDR_CRDE % TYPE;
  V_DEVO_SOMAR_DIA BOOLEAN;
  V_FERIADO NUMBER;
  V_QTD_DIAS_LQDC NUMBER;
  --CURSOR
  CURSOR C_CURSOR IS
  SELECT
    ROWID,
    CD_BNDR,
    DT_RFRN_MVMN,
    CD_TIPO_PLTF_PGMN,
    CD_CRDE,
    CD_EMSR,
    CD_PCSR,
    NU_RMSA_EMSR,
    NU_SQNL,
    NU_RFRN,
    CD_ATZC_TRNS,
    CD_TIPO_TRNS_BNDR_RECB,
    TX_VALR_VNDA,
    TX_VALR_ORGM_TRNE_FNDO,
    NU_PRCL,
    TX_QNTD_TOTL_PRCL,
    TX_VALR_TRNS,
    TX_DATA_VNDA,
    HR_VNDA,
    DT_VNDA,
    TX_VALR_TAXA_EMBQ,
    CD_PRDT_BNDR_RECB,
    CD_MODA_RECB,
    TX_QNTD_DIA_LQDC_EMSR_BNDR,
    QT_DIA_LQDC_BNDR_CRDE,
    CD_PDV_RECB,
    CD_MCC_BNDR_RECB,
    SG_TPPS_RECB,
    CD_TIPO_APRS_TRNS_RECB,
    CD_MTVO_TRNE_FNDO_RECB,
    CD_MTVO_CHRG_RECB,
    CD_TIPO_STCO_PCSM,
    IN_RGST_ATVO,
    CD_TIPO_ACAO_RGST,
    TX_NMRO_CPF_CLNT,
    TX_NMRO_DV_CPF_CLNT,
    TX_NMRO_RAIZ_CNPJ_CLNT,
    TX_NMRO_FILI_CNPJ_CLNT,
    TX_NMRO_DV_CNPJ_CLNT,
    CD_MTVO_FRDE_RECB,
    IN_LNCM_CRTO_PSEN,
    DT_LQDC_EMSR_BNDR,
    CD_RASD_CICL_VIDA_TRNS,
    CD_TIPO_MODO_CMNC_TRNS,
    CD_POCS_ATZC_TRNS,
    CD_RGRA_OPRC_TRNS,
    IN_CLCL_LQDC_DAUT
  FROM
    CLC.TBCLCR_LNCM_PNDT
  WHERE
    CD_TIPO_STCO_PCSM = 'PEN'
    AND CD_BNDR = V_CD_BNDR
    AND CD_CRDE = V_CD_CRDE
    AND CD_TIPO_PLTF_PGMN = V_CD_TIPO_PLTF_PGMN
    AND (
      CASE
        WHEN CD_PRDT_BNDR_RECB = 72
        AND TX_QNTD_TOTL_PRCL = 0 THEN 'NOK'
        WHEN CD_PRDT_BNDR_RECB = 72
        AND CD_TIPO_TRNS_BNDR_RECB = 55
        AND (
          TX_VALR_TRNS = 0
          OR TX_VALR_VNDA = 0
        ) THEN 'NOK'
        ELSE 'OK'
      END
    ) = 'OK';
  TYPE TYPE_CURSOR IS TABLE OF C_CURSOR % ROWTYPE INDEX BY BINARY_INTEGER;
  R_CURSOR TYPE_CURSOR;
  BEGIN
    V_RET: = 0;
  OPEN C_CURSOR;
  LOOP
    FETCH C_CURSOR BULK COLLECT INTO R_CURSOR
  LIMIT
    V_COMMIT_INTERVAL;
  EXIT
    WHEN R_CURSOR.COUNT = 0;
  FOR I IN 1 .. R_CURSOR.COUNT
  LOOP
    --SETA ID SEQUENCE
  SELECT
    SQR_LNCM_RECB.NEXTVAL INTO V_NU_SQNL
  FROM
    DUAL;
  --SETA DATA CICLO E VARIAVEIS PARA CALCULO FERIADO
  SELECT
    DT_PCSM_ATUL,
    EXTRACT(
      YEAR
      FROM
        DT_PCSM_ATUL
    ),
    EXTRACT(
      YEAR
      FROM
        ADD_MONTHS(DT_PCSM_ATUL, 12)
    ) INTO V_DT_RFRN_MVMN,
    V_YY_INICIO,
    V_YY_FINAL
  FROM
    CCR.TBCCRR_CICL_PCSM_CDST;
  IF (R_CURSOR(I) .IN_CLCL_LQDC_DAUT = 'N') THEN V_DT_LQDC_BNDR_CRDE: = V_DT_RFRN_MVMN + R_CURSOR(I) .QT_DIA_LQDC_BNDR_CRDE;
  --SETA DIA UTIL LIQUIDACAO
    V_DEVO_SOMAR_DIA: = TRUE;
  WHILE(V_DEVO_SOMAR_DIA)
  LOOP
    V_FERIADO: = 0;
  BEGIN
  SELECT
    1 INTO V_FERIADO
  FROM
    CNTRPCSM.TBSHRR_HOLIDAY H
    JOIN CNTRPCSM.TBSHRR_BUSINESS_PROC_HOLIDAY PH ON PH.CD_HOLIDAY = H.CD_HOLIDAY
    JOIN CNTRPCSM.TBSHRR_BUSINESS_PROCESS P ON P.CD_BUSINESS_PROCESS = PH.CD_BUSINESS_PROCESS
  WHERE
    P.CD_BUSINESS_PROCESS = V_CD_BUSINESS_PROCESS
    AND H.DD_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'DD')
    AND H.MM_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'MM')
    AND H.YY_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'YYYY');
  EXCEPTION
    WHEN NO_DATA_FOUND THEN NULL;
  END;
  IF (
    (
      TO_CHAR(
        V_DT_LQDC_BNDR_CRDE,
        'DY',
        'NLS_DATE_LANGUAGE = ENGLISH'
      ) IN ('SAT', 'SUN')
    )
    OR (V_FERIADO = 1)
  ) THEN V_DT_LQDC_BNDR_CRDE: = V_DT_LQDC_BNDR_CRDE + 1;
  ELSE V_DEVO_SOMAR_DIA: = FALSE;
  END IF;
  END
  LOOP;
    ELSE V_QTD_DIAS_LQDC: = R_CURSOR(I) .QT_DIA_LQDC_BNDR_CRDE;
  V_DT_LQDC_BNDR_CRDE: = V_DT_RFRN_MVMN;
  WHILE (V_QTD_DIAS_LQDC > 0)
  LOOP
    V_DT_LQDC_BNDR_CRDE: = V_DT_LQDC_BNDR_CRDE + 1;
  --SETA DIA UTIL LIQUIDACAO
    V_DEVO_SOMAR_DIA: = TRUE;
  WHILE(V_DEVO_SOMAR_DIA)
  LOOP
    V_FERIADO: = 0;
  BEGIN
  SELECT
    1 INTO V_FERIADO
  FROM
    CNTRPCSM.TBSHRR_HOLIDAY H
    JOIN CNTRPCSM.TBSHRR_BUSINESS_PROC_HOLIDAY PH ON PH.CD_HOLIDAY = H.CD_HOLIDAY
    JOIN CNTRPCSM.TBSHRR_BUSINESS_PROCESS P ON P.CD_BUSINESS_PROCESS = PH.CD_BUSINESS_PROCESS
  WHERE
    P.CD_BUSINESS_PROCESS = V_CD_BUSINESS_PROCESS
    AND H.DD_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'DD')
    AND H.MM_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'MM')
    AND H.YY_HOLIDAY = TO_CHAR(V_DT_LQDC_BNDR_CRDE, 'YYYY');
  EXCEPTION
    WHEN NO_DATA_FOUND THEN NULL;
  END;
  IF (
    (
      TO_CHAR(
        V_DT_LQDC_BNDR_CRDE,
        'DY',
        'NLS_DATE_LANGUAGE = ENGLISH'
      ) IN ('SAT', 'SUN')
    )
    OR (V_FERIADO = 1)
  ) THEN V_DT_LQDC_BNDR_CRDE: = V_DT_LQDC_BNDR_CRDE + 1;
  ELSE V_DEVO_SOMAR_DIA: = FALSE;
  END IF;
  END
  LOOP;
  V_QTD_DIAS_LQDC: = V_QTD_DIAS_LQDC - 1;
  END
  LOOP;
  END IF;
  --EFETIVA LANCAMENTO PENDENTES
  INSERT INTO
    CLC.TBCLCR_LNCM_RECB (
      CD_BNDR,
      CD_TIPO_PLTF_PGMN,
      CD_CRDE,
      CD_EMSR,
      CD_PCSR,
      NU_RMSA_EMSR,
      NU_RFRN,
      CD_ATZC_TRNS,
      CD_TIPO_TRNS_BNDR_RECB,
      TX_VALR_VNDA,
      TX_VALR_ORGM_TRNE_FNDO,
      NU_PRCL,
      TX_QNTD_TOTL_PRCL,
      TX_VALR_TRNS,
      TX_DATA_VNDA,
      HR_VNDA,
      DT_VNDA,
      TX_VALR_TAXA_EMBQ,
      CD_PRDT_BNDR_RECB,
      CD_MODA_RECB,
      TX_QNTD_DIA_LQDC_EMSR_BNDR,
      QT_DIA_LQDC_BNDR_CRDE,
      CD_PDV_RECB,
      CD_MCC_BNDR_RECB,
      CD_TIPO_APRS_TRNS_RECB,
      CD_MTVO_TRNE_FNDO_RECB,
      CD_MTVO_CHRG_RECB,
      IN_RGST_ATVO,
      CD_TIPO_ACAO_RGST,
      SG_TPPS_RECB,
      TX_NMRO_CPF_CLNT,
      TX_NMRO_DV_CPF_CLNT,
      TX_NMRO_RAIZ_CNPJ_CLNT,
      TX_NMRO_FILI_CNPJ_CLNT,
      TX_NMRO_DV_CNPJ_CLNT,
      CD_MTVO_FRDE_RECB,
      CD_RASD_CICL_VIDA_TRNS,
      IN_LNCM_CRTO_PSEN,
      DT_LQDC_EMSR_BNDR,
      CD_POCS_ATZC_TRNS,
      CD_TIPO_MODO_CMNC_TRNS,
      CD_RGRA_OPRC_TRNS,
      --CAMPOS DE VARIAVEIS
      DT_RFRN_MVMN,
      DT_RERO_EMSR,
      NU_SQNL,
      TX_QNTD_DIA_LQDC_CRDE_BNDR,
      QT_DIA_LQDC_BNDR_EMSR,
      SG_ORGM_IFMC_RECB,
      DH_INCL_RGST,
      CD_USRO_INCL_RGST,
      CD_USRO_ACAO_RGST,
      CD_ERRO_PCSM_LQDC_RECB,
      CD_TIPO_MVMC_PARC,
      CD_TIPO_STCO_PCSM,
      IN_ENVO_ANLT_CRDE_BNDR_EMSR,
      IN_AUTC_SGRN,
      QT_DIA_PDRO_LQDC_EMSR,
      QT_DIA_PDRO_PGMN_PDV,
      DT_LQDC_BNDR_CRDE,
      NU_RMSA_CRDE
    )
  VALUES
    (
      R_CURSOR(I) .CD_BNDR,
      R_CURSOR(I) .CD_TIPO_PLTF_PGMN,
      R_CURSOR(I) .CD_CRDE,
      R_CURSOR(I) .CD_EMSR,
      R_CURSOR(I) .CD_PCSR,
      R_CURSOR(I) .NU_RMSA_EMSR,
      R_CURSOR(I) .NU_RFRN,
      R_CURSOR(I) .CD_ATZC_TRNS,
      R_CURSOR(I) .CD_TIPO_TRNS_BNDR_RECB,
      R_CURSOR(I) .TX_VALR_VNDA,
      R_CURSOR(I) .TX_VALR_ORGM_TRNE_FNDO,
      R_CURSOR(I) .NU_PRCL,
      R_CURSOR(I) .TX_QNTD_TOTL_PRCL,
      R_CURSOR(I) .TX_VALR_TRNS,
      R_CURSOR(I) .TX_DATA_VNDA,
      R_CURSOR(I) .HR_VNDA,
      COALESCE(R_CURSOR(I) .DT_VNDA, TRUNC(SYSDATE)),
      R_CURSOR(I) .TX_VALR_TAXA_EMBQ,
      R_CURSOR(I) .CD_PRDT_BNDR_RECB,
      R_CURSOR(I) .CD_MODA_RECB,
      R_CURSOR(I) .TX_QNTD_DIA_LQDC_EMSR_BNDR,
      R_CURSOR(I) .QT_DIA_LQDC_BNDR_CRDE,
      COALESCE(LTRIM(R_CURSOR(I) .CD_PDV_RECB, '0'), '0'),
      R_CURSOR(I) .CD_MCC_BNDR_RECB,
      R_CURSOR(I) .CD_TIPO_APRS_TRNS_RECB,
      R_CURSOR(I) .CD_MTVO_TRNE_FNDO_RECB,
      R_CURSOR(I) .CD_MTVO_CHRG_RECB,
      R_CURSOR(I) .IN_RGST_ATVO,
      R_CURSOR(I) .CD_TIPO_ACAO_RGST,
      R_CURSOR(I) .SG_TPPS_RECB,
      R_CURSOR(I) .TX_NMRO_CPF_CLNT,
      R_CURSOR(I) .TX_NMRO_DV_CPF_CLNT,
      R_CURSOR(I) .TX_NMRO_RAIZ_CNPJ_CLNT,
      R_CURSOR(I) .TX_NMRO_FILI_CNPJ_CLNT,
      R_CURSOR(I) .TX_NMRO_DV_CNPJ_CLNT,
      R_CURSOR(I) .CD_MTVO_FRDE_RECB,
      R_CURSOR(I) .CD_RASD_CICL_VIDA_TRNS,
      R_CURSOR(I) .IN_LNCM_CRTO_PSEN,
      R_CURSOR(I) .DT_LQDC_EMSR_BNDR,
      R_CURSOR(I) .CD_POCS_ATZC_TRNS,
      R_CURSOR(I) .CD_TIPO_MODO_CMNC_TRNS,
      R_CURSOR(I) .CD_RGRA_OPRC_TRNS,
      --DATA CICLO, DATA CICLO, ID SEQUENCE, QTD DIA LIQUIDACAO CREDENCIADORA, QTD DIA LIQUIDACAO EMISSOR, ORIGEM
      V_DT_RFRN_MVMN,
      V_DT_RFRN_MVMN,
      V_NU_SQNL,
      V_TX_QNTD_DIA_LQDC_CRDE_BNDR,
      V_QT_DIA_LQDC_BNDR_EMSR,
      V_SG_ORGM_IFMC_RECB,
      --DATA INSERT, USUARIO INCLUSAO RGST, USUARIO ACAO RGST, CODIGO ERRO PROCESSAMENTO,
      V_DH_INCL_RGST,
      V_CD_USRO_INCL_RGST,
      V_CD_USRO_INCL_RGST,
      V_CD_ERRO_PCSM_LQDC_RECB,
      V_CD_TIPO_MVMC_PARC,
      --SITUACAO PROCESSAMENTO, INDICADOR ENVIO AGENDA, INDICADOR SEGURANCA, QTD DIA PADRAO EMISSOR, QTD DIA PADRAO PDV
      V_CD_TIPO_STCO_PCSM,
      V_IN_ENVO_ANLT_CRDE_BNDR_EMSR,
      V_IN_AUTC_SGRN,
      V_QT_DIA_PDRO_LQDC_EMSR,
      V_QT_DIA_PDRO_PGMN_PDV,
      --DIA UTIL LIQUIDACAO, REMESSA CRDE, ORIGEM INFM
      V_DT_LQDC_BNDR_CRDE,
      V_NU_RMSA_CRDE
    );
  --EFETIVA LANCAMENTOS PENDENTES CARTAO CRIPTOGRAFADO
  INSERT INTO
    CLC.TBCLCR_CRTO_CRPT_LNCM_RECB (
      CD_BNDR,
      CD_TIPO_PLTF_PGMN,
      CD_CRDE,
      CD_EMSR,
      CD_PCSR,
      NU_RMSA_EMSR,
      CD_TIPO_CNCT_CRTO,
      NU_BIN_RECB,
      NU_FINL_CRTO_RECB,
      CD_IDTF_CHVE_CRTO,
      NU_CRTO_CRPT_PCSR_RECB,
      NU_HASH_CRTO_PCSR_RECB,
      CD_IDTF_CHVE_BNDR,
      NU_CRTO_CRPT_BNDR_RECB,
      NU_HASH_CRTO_BNDR_RECB,
      CD_NIVL_SGRN_RECB,
      NU_IDTF_RQSE_RECB,
      --CAMPOS DE VARIAVEIS
      DT_RFRN_MVMN,
      NU_SQNL,
      NU_RMSA_CRDE
    )
  SELECT
    CD_BNDR,
    CD_TIPO_PLTF_PGMN,
    CD_CRDE,
    CD_EMSR,
    CD_PCSR,
    NU_RMSA_EMSR,
    CD_TIPO_CNCT_CRTO,
    NU_BIN_PNDT,
    NU_FINL_CRTO_PNDT,
    CD_IDTF_CHVE_CRTO,
    NU_CRTO_CRPT_PCSR_PNDT,
    NU_HASH_CRTO_PCSR_PNDT,
    CD_IDTF_CHVE_BNDR,
    NU_CRTO_CRPT_BNDR_PNDT,
    NU_HASH_CRTO_BNDR_PNDT,
    CD_NIVL_SGRN_PNDT,
    NU_IDTF_RQSE_PNDT,
    --DATA CICLO, ID SEQUENCE, REMESSA CREDENCIADOR
    V_DT_RFRN_MVMN,
    V_NU_SQNL,
    V_NU_RMSA_CRDE
  FROM
    CLC.TBCLCR_CRTO_CRPT_LNCM_PNDT
  WHERE
    CD_BNDR = R_CURSOR(I) .CD_BNDR
    AND DT_RFRN_MVMN = R_CURSOR(I) .DT_RFRN_MVMN
    AND CD_TIPO_PLTF_PGMN = R_CURSOR(I) .CD_TIPO_PLTF_PGMN
    AND CD_CRDE = R_CURSOR(I) .CD_CRDE
    AND CD_EMSR = R_CURSOR(I) .CD_EMSR
    AND CD_PCSR = R_CURSOR(I) .CD_PCSR
    AND NU_RMSA_EMSR = R_CURSOR(I) .NU_RMSA_EMSR
    AND NU_SQNL = R_CURSOR(I) .NU_SQNL;
  --EFETIVA TRANSACAO ELETRONICA
  INSERT INTO
    CLC.TBCLCR_TRNS_ETNC_LNCM_RECB (
      CD_BNDR,
      CD_TIPO_PLTF_PGMN,
      CD_CRDE,
      CD_EMSR,
      CD_PCSR,
      NU_RMSA_EMSR,
      NU_SQNL_RGST_TRNS_ETNC,
      TX_RGST_LNCM_TRNS_ETNC,
      --CAMPOS DE VARIAVEIS
      DT_RFRN_MVMN,
      NU_SQNL,
      CD_USRO_INCL_RGST,
      DH_INCL_RGST,
      NU_RMSA_CRDE
    )
  SELECT
    R_CURSOR(I) .CD_BNDR,
    R_CURSOR(I) .CD_TIPO_PLTF_PGMN,
    R_CURSOR(I) .CD_CRDE,
    R_CURSOR(I) .CD_EMSR,
    R_CURSOR(I) .CD_PCSR,
    R_CURSOR(I) .NU_RMSA_EMSR,
    NU_SQNL_RGST_TRNS_ETNC,
    TX_RGST_LNCM_TRNS_ETNC,
    --DATA CICLO, ID SEQUENCE, USUARIO INCLUSAO RGST, DATA INSERT, REMESSA CREDENCIADOR
    V_DT_RFRN_MVMN,
    V_NU_SQNL,
    V_CD_USRO_INCL_RGST,
    V_DH_INCL_RGST,
    V_NU_RMSA_CRDE
  FROM
    CLC.TBCLCR_TRNS_ETNC_LNCM_PNDT
  WHERE
    CD_BNDR = R_CURSOR(I) .CD_BNDR
    AND DT_RFRN_MVMN = R_CURSOR(I) .DT_RFRN_MVMN
    AND CD_TIPO_PLTF_PGMN = R_CURSOR(I) .CD_TIPO_PLTF_PGMN
    AND CD_CRDE = R_CURSOR(I) .CD_CRDE
    AND CD_EMSR = R_CURSOR(I) .CD_EMSR
    AND CD_PCSR = R_CURSOR(I) .CD_PCSR
    AND NU_RMSA_EMSR = R_CURSOR(I) .NU_RMSA_EMSR
    AND NU_SQNL = R_CURSOR(I) .NU_SQNL;
  --ATUALIZA LANCAMENTOS PENDENTES PARA MOVIDOS
  UPDATE
    CLC.TBCLCR_LNCM_PNDT
  SET
    CD_TIPO_STCO_PCSM = 'MOV'
  WHERE
    ROWID = R_CURSOR(I) .ROWID;
  V_RET: = V_RET + 1;
  END
  LOOP;
  COMMIT;
  END
  LOOP
    C_CURSOR;
  CLOSE C_CURSOR;
  COMMIT;
  END;
