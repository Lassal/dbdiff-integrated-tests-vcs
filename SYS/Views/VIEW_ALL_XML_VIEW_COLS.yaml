schema: SYS
name: ALL_XML_VIEW_COLS
updatedAllowed: true
insertAllowed: true
columns:
- name: COLUMN_NAME
  dataType: VARCHAR2
  textMaxLength: 4000
  nullable: true
  ordinalPosition: 3
  dataTypeLength: 4000
- name: ELEMENT_NAME
  dataType: VARCHAR2
  textMaxLength: 2000
  nullable: true
  ordinalPosition: 6
  dataTypeLength: 2000
- name: OWNER
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 1
  dataTypeLength: 128
- name: SCHEMA_OWNER
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 5
  dataTypeLength: 128
- name: VIEW_NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 2
  dataTypeLength: 128
- name: XMLSCHEMA
  dataType: VARCHAR2
  textMaxLength: 700
  nullable: true
  ordinalPosition: 4
  dataTypeLength: 700
referencedTables:
- schema: SYS
  name: ATTRCOL$
- schema: SYS
  name: COL$
- schema: SYS
  name: COLTYPE$
- schema: SYS
  name: OBJ$
- schema: SYS
  name: OBJAUTH$
- schema: SYS
  name: OPQTYPE$
- schema: SYS
  name: USER$
- schema: SYS
  name: V$ENABLEDPRIVS
- schema: SYS
  name: VIEW$
- schema: SYS
  name: X$KZSRO
- schema: XDB
  name: XDB$ELEMENT
- schema: XDB
  name: XDB$SCHEMA
viewDefinition: |-
  select
    u.name,
    o.name,
    decode(bitand(tc.property, 1), 1, attr.name, tc.name),
    null,
    null,
    null
  from
    sys.opqtype$ opq,
    sys.view$ v,
    sys.user$ u,
    sys.obj$ o,
    sys.coltype$ ac,
    sys.col$ tc,
    sys.attrcol$ attr
  where
    o.owner# = u.user#
    and o.obj# = v.obj#
    and bitand(v.property, 1) = 1
    and v.obj# = tc.obj#
    and tc.obj# = ac.obj#
    and tc.intcol# = ac.intcol#
    and ac.toid = '00000000000000000000000000020100'
    and tc.intcol# = opq.intcol#
    and tc.obj# = opq.obj#
    and tc.obj# = attr.obj#(+)
    and tc.intcol# = attr.intcol#(+)
    and bitand(opq.flags, 2) = 0
    and (
      o.owner# = userenv('SCHEMAID')
      or o.obj# in (
        select
          oa.obj#
        from
          sys.objauth$ oa
        where
          grantee# in (
            select
              kzsrorol
            from
              x$kzsro
          )
      )
      or
      /* user has system privileges */
      exists (
        select
          null
        from
          v$enabledprivs
        where
          priv_number in (
            -45
            /* LOCK ANY VIEWLE */,
            -47
            /* SELECT ANY VIEWLE */,
            -397
            /* READ ANY VIEWLE */,
            -48
            /* INSERT ANY VIEWLE */,
            -49
            /* UPDATE ANY VIEWLE */,
            -50
            /* DELETE ANY VIEWLE */
          )
      )
    )
  union all
  select
    u.name,
    o.name,
    decode(bitand(tc.property, 1), 1, attr.name, tc.name),
    schm.xmldata.schema_url,
    schm.xmldata.schema_owner,
    decode(
      xel.xmldata.property.name,
      null,
      xel.xmldata.property.propref_name.name,
      xel.xmldata.property.name
    )
  from
    xdb.xdb$element xel,
    xdb.xdb$schema schm,
    sys.opqtype$ opq,
    sys.view$ v,
    sys.user$ u,
    sys.obj$ o,
    sys.coltype$ ac,
    sys.col$ tc,
    sys.attrcol$ attr
  where
    o.owner# = u.user#
    and o.obj# = v.obj#
    and bitand(v.property, 1) = 1
    and v.obj# = tc.obj#
    and tc.obj# = ac.obj#
    and tc.intcol# = ac.intcol#
    and ac.toid = '00000000000000000000000000020100'
    and tc.intcol# = opq.intcol#
    and tc.obj# = opq.obj#
    and tc.obj# = attr.obj#(+)
    and tc.intcol# = attr.intcol#(+)
    and opq.schemaoid = schm.sys_nc_oid$
    and opq.elemnum = xel.xmldata.property.prop_number
    and (
      o.owner# = userenv('SCHEMAID')
      or o.obj# in (
        select
          oa.obj#
        from
          sys.objauth$ oa
        where
          grantee# in (
            select
              kzsrorol
            from
              x$kzsro
          )
      )
      or
      /* user has system privileges */
      exists (
        select
          null
        from
          v$enabledprivs
        where
          priv_number in (
            -45
            /* LOCK ANY VIEWLE */,
            -47
            /* SELECT ANY VIEWLE */,
            -397
            /* READ ANY VIEWLE */,
            -48
            /* INSERT ANY VIEWLE */,
            -49
            /* UPDATE ANY VIEWLE */,
            -50
            /* DELETE ANY VIEWLE */
          )
      )
    )
