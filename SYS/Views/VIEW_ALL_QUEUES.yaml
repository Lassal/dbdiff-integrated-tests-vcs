schema: SYS
name: ALL_QUEUES
updatedAllowed: true
insertAllowed: true
columns:
- name: DEQUEUE_ENABLED
  dataType: VARCHAR2
  textMaxLength: 7
  nullable: true
  ordinalPosition: 9
  dataTypeLength: 7
- name: ENQUEUE_ENABLED
  dataType: VARCHAR2
  textMaxLength: 7
  nullable: true
  ordinalPosition: 8
  dataTypeLength: 7
- name: MAX_RETRIES
  dataType: NUMBER
  nullable: true
  ordinalPosition: 6
  dataTypeLength:
- name: NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 2
  dataTypeLength: 128
- name: NETWORK_NAME
  dataType: VARCHAR2
  textMaxLength: 512
  nullable: true
  ordinalPosition: 12
  dataTypeLength: 512
- name: OWNER
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 1
  dataTypeLength: 128
- name: QID
  dataType: NUMBER
  nullable: false
  ordinalPosition: 4
  dataTypeLength:
- name: QUEUE_TABLE
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 3
  dataTypeLength: 128
- name: QUEUE_TYPE
  dataType: VARCHAR2
  textMaxLength: 20
  nullable: true
  ordinalPosition: 5
  dataTypeLength: 20
- name: RETENTION
  dataType: VARCHAR2
  textMaxLength: 40
  nullable: true
  ordinalPosition: 10
  dataTypeLength: 40
- name: RETRY_DELAY
  dataType: NUMBER
  nullable: true
  ordinalPosition: 7
  dataTypeLength:
- name: SHARDED
  dataType: VARCHAR2
  textMaxLength: 5
  nullable: true
  ordinalPosition: 13
  dataTypeLength: 5
- name: USER_COMMENT
  dataType: VARCHAR2
  textMaxLength: 50
  nullable: true
  ordinalPosition: 11
  dataTypeLength: 50
referencedTables:
- schema: SYS
  name: DBA_SERVICES
- schema: SYS
  name: OBJ$
- schema: SYS
  name: OBJAUTH$
- schema: SYS
  name: USER$
- schema: SYS
  name: V$ENABLEDPRIVS
- schema: SYS
  name: X$KZSRO
- schema: SYSTEM
  name: AQ$_QUEUES
- schema: SYSTEM
  name: AQ$_QUEUE_TABLES
viewDefinition: |-
  select
    u.name OWNER,
    q.name NAME,
    t.name QUEUE_TABLE,
    q.eventid QID,
    decode(
      q.usage,
      1,
      'EXCEPTION_QUEUE',
      2,
      'NON_PERSISTENT_QUEUE',
      'NORMAL_QUEUE'
    ) QUEUE_TYPE,
    q.max_retries MAX_RETRIES,
    q.retry_delay RETRY_DELAY,
    decode(
      bitand(q.enable_flag, 1),
      1,
      '  YES  ',
      '  NO  '
    ) ENQUEUE_ENABLED,
    decode(
      bitand(q.enable_flag, 2),
      2,
      '  YES  ',
      '  NO  '
    ) DEQUEUE_ENABLED,
    decode(q.ret_time, -1, ' FOREVER', q.ret_time) RETENTION,
    substr(q.queue_comment, 1, 50) USER_COMMENT,
    s.network_name NETWORK_NAME,
    decode(q.sharded, 1, 'TRUE', 'FALSE') SHARDED
  from
    system.aq$_queues q,
    system.aq$_queue_tables t,
    sys.user$ u,
    sys.obj$ ro,
    dba_services s
  where
    u.name = t.schema
    and q.table_objno = t.objno
    and ro.owner# = u.user#
    and ro.obj# = q.eventid
    and (
      ro.owner# = userenv('SCHEMAID')
      or ro.obj# in (
        select
          oa.obj#
        from
          sys.objauth$ oa
        where
          grantee# in (
            select
              kzsrorol
            from
              x$kzsro
          )
      )
      or exists (
        select
          null
        from
          v$enabledprivs
        where
          priv_number in (
            -218
            /* MANAGE ANY QUEUE */,
            -219
            /* ENQUEUE ANY QUEUE */,
            -220
            /* DEQUEUE ANY QUEUE */
          )
      )
      or ro.obj# in (
        select
          q.eventid
        from
          system.aq$_queues q,
          system.aq$_queue_tables t
        where
          q.table_objno = t.objno
          and bitand(t.flags, 8) = 0
          and exists (
            select
              null
            from
              sys.objauth$ oa,
              sys.obj$ o
            where
              oa.obj# = o.obj#
              and (
                o.name = 'DBMS_AQ'
                or o.name = 'DBMS_AQADM'
              )
              and o.owner# = 0
              and o.type# = 9
              and oa.grantee# = userenv('SCHEMAID')
          )
      )
    )
    and q.service_name = s.name (+)
