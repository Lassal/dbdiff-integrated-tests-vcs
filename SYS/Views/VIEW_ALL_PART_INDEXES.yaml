schema: SYS
name: ALL_PART_INDEXES
updatedAllowed: true
insertAllowed: true
viewDefinition: |-
  select
    u.name,
    io.name,
    o.name,
    decode(
      po.parttype,
      1,
      'RANGE',
      2,
      'HASH',
      3,
      'SYSTEM',
      4,
      'LIST',
      5,
      'REFERENCE',
      'UNKNOWN'
    ),
    decode(
      mod(po.spare2, 256),
      0,
      'NONE',
      1,
      'RANGE',
      2,
      'HASH',
      3,
      'SYSTEM',
      4,
      'LIST',
      5,
      'REFERENCE',
      'UNKNOWN'
    ),
    po.partcnt,
    mod(trunc(po.spare2 / 65536), 65536),
    po.partkeycols,
    mod(trunc(po.spare2 / 256), 256),
    decode(bitand(po.flags, 1), 1, 'LOCAL', 'GLOBAL'),
    decode(
      po.partkeycols,
      0,
      'NONE',
      decode(
        bitand(po.flags, 2),
        2,
        'PREFIXED',
        'NON_PREFIXED'
      )
    ),
    ts.name,
    po.defpctfree,
    po.definitrans,
    po.defmaxtrans,
    decode(po.deftiniexts, NULL, 'DEFAULT', po.deftiniexts),
    decode(po.defextsize, NULL, 'DEFAULT', po.defextsize),
    decode(po.defminexts, NULL, 'DEFAULT', po.defminexts),
    decode(po.defmaxexts, NULL, 'DEFAULT', po.defmaxexts),
    decode(po.defmaxsize, NULL, 'DEFAULT', po.defmaxsize),
    decode(po.defextpct, NULL, 'DEFAULT', po.defextpct),
    po.deflists,
    po.defgroups,
    decode(
      po.deflogging,
      0,
      'NONE',
      1,
      'YES',
      2,
      'NO',
      'UNKNOWN'
    ),
    decode(
      bitand(po.spare1, 3),
      1,
      'KEEP',
      2,
      'RECYCLE',
      'DEFAULT'
    ),
    decode(
      bitand(po.spare1, 12) / 4,
      1,
      'KEEP',
      2,
      'NONE',
      'DEFAULT'
    ),
    decode(
      bitand(po.spare1, 48) / 16,
      1,
      'KEEP',
      2,
      'NONE',
      'DEFAULT'
    ),
    po.parameters,
    case
      when (
        po.parttype = 5
        and bitand(po.flags, 64) = 64
      ) then 'YES'
      else po.interval_str
    end
  from
    sys.obj$ io,
    sys.obj$ o,
    sys.partobj$ po,
    sys.ts$ ts,
    sys.ind$ i,
    sys.user$ u
  where
    io.obj# = po.obj#
    and po.defts# = ts.ts# (+)
    and i.obj# = io.obj#
    and o.obj# = i.bo#
    and u.user# = io.owner#
    and i.type# != 8
    and
    /* not LOB index */
    io.subname IS NULL
    and io.namespace = 4
    and io.remoteowner IS NULL
    and io.linkname IS NULL
    and (
      io.owner# = userenv('SCHEMAID')
      or i.bo# in (
        select
          obj#
        from
          objauth$
        where
          grantee# in (
            select
              kzsrorol
            from
              x$kzsro
          )
      )
      or exists (
        select
          null
        from
          v$enabledprivs
        where
          priv_number in (
            -45
            /* LOCK ANY TABLE */,
            -47
            /* SELECT ANY TABLE */,
            -397
            /* READ ANY TABLE */,
            -48
            /* INSERT ANY TABLE */,
            -49
            /* UPDATE ANY TABLE */,
            -50
            /* DELETE ANY TABLE */
          )
      )
    )
columns: []
referencedTables: []
