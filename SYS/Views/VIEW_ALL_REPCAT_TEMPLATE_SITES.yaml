schema: SYS
name: ALL_REPCAT_TEMPLATE_SITES
updatedAllowed: true
insertAllowed: true
columns:
- name: INSTANTIATION_DATE
  dataType: DATE
  nullable: true
  ordinalPosition: 8
  dataTypeLength:
- name: REFRESH_GROUP_NAME
  dataType: VARCHAR2
  textMaxLength: 30
  nullable: true
  ordinalPosition: 2
  dataTypeLength: 30
- name: REFRESH_TEMPLATE_NAME
  dataType: VARCHAR2
  textMaxLength: 30
  nullable: false
  ordinalPosition: 1
  dataTypeLength: 30
- name: REPAPI_SITE_NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 6
  dataTypeLength: 128
- name: SITE_NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 5
  dataTypeLength: 128
- name: STATUS
  dataType: VARCHAR2
  textMaxLength: 10
  nullable: true
  ordinalPosition: 7
  dataTypeLength: 10
- name: TEMPLATE_OWNER
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: true
  ordinalPosition: 3
  dataTypeLength: 128
- name: USER_NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 4
  dataTypeLength: 128
referencedTables:
- schema: SYS
  name: ALL_USERS
- schema: SYS
  name: SNAP_SITE$
- schema: SYS
  name: USER$
- schema: SYS
  name: V$ENABLEDPRIVS
- schema: SYSTEM
  name: REPCAT$_REFRESH_TEMPLATES
- schema: SYSTEM
  name: REPCAT$_TEMPLATE_SITES
- schema: SYSTEM
  name: REPCAT$_TEMPLATE_TYPES
- schema: SYSTEM
  name: REPCAT$_USER_AUTHORIZATIONS
viewDefinition: |-
  select
    ts.refresh_template_name,
    ts.refresh_group_name,
    ts.template_owner,
    ts.user_name,
    ts.site_name,
    ss.site_name,
    decode(
      status,
      -1,
      'DELETED',
      0,
      'INSTALLING',
      1,
      'INSTALLED',
      'UNDEFINED'
    ),
    instantiation_date
  from
    system.repcat$_template_sites ts,
    sys.snap_site$ ss,
    system.repcat$_refresh_templates rt,
    system.repcat$_template_types tt
  where
    ts.repapi_site_id = ss.site_id (+)
    and ts.status != -100
    and rt.refresh_template_name = ts.refresh_template_name
    and rt.template_type_id = tt.template_type_id
    and bitand(rawtohex(tt.flags), 1) = 1
    and rt.refresh_template_id in (
      select
        rt.refresh_template_id
      from
        system.repcat$_refresh_templates
      where
        public_template = 'Y'
      union
      select
        rt.refresh_template_id
      from
        system.repcat$_refresh_templates rt,
        system.repcat$_user_authorizations at,
        sys.all_users au
      where
        at .refresh_template_id = rt.refresh_template_id
        and au.user_id = at .user_id
        and nvl(rt.public_template, 'N') = 'N'
        and au.user_id = userenv('SCHEMAID')
      union
      select
        rt.refresh_template_id
      from
        system.repcat$_refresh_templates rt
      where
        nvl(rt.public_template, 'N') = 'N'
        and exists (
          select
            1
          from
            v$enabledprivs
          where
            priv_number in (
              -174
              /* alter any snapshot */
            )
        )
      union
      select
        rt.refresh_template_id
      from
        system.repcat$_refresh_templates rt,
        sys.user$ u
      where
        nvl(rt.public_template, 'N') = 'N'
        and rt.owner = u.name
        and u.user# = userenv('SCHEMAID')
    )
