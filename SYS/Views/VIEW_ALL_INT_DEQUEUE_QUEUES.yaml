schema: SYS
name: ALL_INT_DEQUEUE_QUEUES
updatedAllowed: true
insertAllowed: true
columns:
- name: NAME
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 2
  dataTypeLength: 128
- name: OWNER
  dataType: VARCHAR2
  textMaxLength: 128
  nullable: false
  ordinalPosition: 1
  dataTypeLength: 128
- name: QID
  dataType: NUMBER
  nullable: false
  ordinalPosition: 3
  dataTypeLength:
referencedTables:
- schema: SYS
  name: OBJ$
- schema: SYS
  name: OBJAUTH$
- schema: SYS
  name: V$ENABLEDPRIVS
- schema: SYS
  name: X$KZSRO
- schema: SYSTEM
  name: AQ$_QUEUES
- schema: SYSTEM
  name: AQ$_QUEUE_TABLES
viewDefinition: |-
  select
    /*+ ORDERED NO_USE_MERGE(ro) */
    t.schema OWNER,
    q.name NAME,
    q.eventid QID
  from
    system.aq$_queues q,
    system.aq$_queue_tables t,
    sys.obj$ ro
  where
    q.table_objno = t.objno
    and ro.obj# = q.eventid
    and (
      ro.owner# = userenv('SCHEMAID')
      or ro.obj# in (
        select
          oa.obj#
        from
          sys.objauth$ oa
        where
          oa.privilege# = 21
          and grantee# in (
            select
              kzsrorol
            from
              x$kzsro
          )
      )
      or exists (
        select
          null
        from
          v$enabledprivs
        where
          priv_number in (
            -218
            /* MANAGE ANY QUEUE */,
            -220
            /* DEQUEUE ANY QUEUE */
          )
      )
      or (
        bitand(t.flags, 8) = 0
        and (
          exists (
            select
              null
            from
              sys.objauth$ oa,
              sys.obj$ o
            where
              oa.obj# = o.obj#
              and o.owner# = 0
              and (
                o.name = 'DBMS_AQ'
                or o.name = 'DBMS_AQADM'
              )
              and o.type# = 9
              and oa.grantee# = userenv('SCHEMAID')
          )
        )
      )
    )
