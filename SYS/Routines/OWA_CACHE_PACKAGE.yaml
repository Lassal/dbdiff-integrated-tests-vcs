schema: SYS
name: OWA_CACHE
routineType: PACKAGE
returnParamater:
  name: GET_LEVEL.(--return--)
  ordinalPosition: 0
  dataType: VARCHAR2
  parameterMode: OUT
parameters:
- name: INIT.P_HTBUF
  ordinalPosition: 1
  dataType: PL/SQL TABLE
  parameterMode: INOUT
- name: INIT.P_ROWS_IN
  ordinalPosition: 2
  dataType: NUMBER
  parameterMode: INOUT
- name: SET_CACHE.P_ETAG
  ordinalPosition: 1
  dataType: VARCHAR2
  parameterMode: IN
- name: SET_CACHE.P_LEVEL
  ordinalPosition: 2
  dataType: VARCHAR2
  parameterMode: IN
- name: SET_EXPIRES.P_EXPIRES
  ordinalPosition: 1
  dataType: NUMBER
  parameterMode: IN
- name: SET_EXPIRES.P_LEVEL
  ordinalPosition: 2
  dataType: VARCHAR2
  parameterMode: IN
- name: SET_SURROGATE_CONTROL.P_VALUE
  ordinalPosition: 1
  dataType: VARCHAR2
  parameterMode: IN
routineDefinition: |-
  PACKAGE owa_cache AS --
  -- Public types and global variables
  --
  -- The different caching levels. For now, just user and system.
  system_level CONSTANT VARCHAR(6): = 'SYSTEM';
  user_level CONSTANT VARCHAR(4): = 'USER';
  --
  -- PROCEDURE:
  --   init
  -- DESCRIPTION:
  --   Reserve header spaces
  -- PARAMS:
  --   p_htbuf    IN/OUT: the buffer to reserve the headers in
  --   p_rows_in  IN/OUT: the current row number in that buffer
  -- NOTE:
  --   Should only be called before any data is written to the htbuf
  --
  PROCEDURE init(
    p_htbuf IN OUT NOCOPY htp.htbuf_arr,
    p_rows_in IN OUT number
  );
  --
  -- PROCEDURE:
  --   disable
  -- DESCRIPTION:
  --   Disables the cache
  --
  PROCEDURE disable;
  --
  -- PROCEDURE:
  --   set_expires
  -- DESCRIPTION:
  --   Sets up the cache headers
  -- PARAMS:
  --   p_expires  IN: number of minutes this cached item is fresh
  --   p_level    IN: the caching level for it (USER or SYSTEM for now)
  -- EXCEPTIONS:
  --   VALUE_ERROR : If p_expires is negative or zero, or p_level is not
  --                 'USER' or 'SYSTEM', this exception is thrown
  --                 If p_expires is > 525600 (1 year), this exception is thrown
  PROCEDURE set_expires(p_expires IN number, p_level IN varchar2);
  --
  -- PROCEDURE:
  --   set_cache
  -- DESCRIPTION:
  --   Sets up the cache headers
  -- PARAMS:
  --   p_etag     IN: the ETag associated with this content
  --   p_level    IN: the caching level for it (USER or SYSTEM for now)
  -- EXCEPTIONS:
  --   VALUE_ERROR : If p_etag is greater than 55 in length or p_level is
  --                 not 'USER' or 'SYSTEM', this exception is thrown
  --
  PROCEDURE set_cache(p_etag IN varchar2, p_level IN varchar2);
  --
  -- PROCEDURE:
  --   set_not_modified
  -- DESCRIPTION:
  --   Sets up the headers for a not modified cache hit
  -- EXCEPTIONS:
  --   VALUE_ERROR : If the ETag wasn't passed in, this exception is thrown
  --
  PROCEDURE set_not_modified;
  --
  -- PROCEDURE:
  --   set_surrogate_control
  -- DESCRIPTION:
  --   Sets up the headers for a surrogate-control header for web cache
  -- PARAMS:
  --   p_value    IN: value to be passed as the Surrogate-Control header
  -- EXCEPTIONS:
  --   VALUE_ERROR : If p_value is greater than 55 in length
  --
  PROCEDURE set_surrogate_control(p_value IN varchar2);
  --
  -- FUNCTION:
  --   get_level
  -- DESCRIPTION:
  --   Returns the caching level
  -- PARAMS:
  --   none
  -- RETURN:
  --   The caching level string (USER or SYSTEM for now)
  --
  FUNCTION get_level RETURN VARCHAR2;
  --
  -- FUNCTION:
  --   get_etag
  -- DESCRIPTION:
  --   Returns the caching etag
  -- PARAMS:
  --   none
  -- RETURN:
  --   The caching etag string
  --
  FUNCTION get_etag RETURN VARCHAR2;
  END owa_cache;
