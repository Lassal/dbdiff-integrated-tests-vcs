schema: CTXSYS
name: DRVODM
routineType: PACKAGE
returnParamater:
  name: ODMTRAINSET.(--return--)
  dataType: TABLE
  parameterMode: OUT
  ordinalPosition: 0
parameters:
- name: FEATURE_EXPLAIN.RESTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: FEATURE_PREP(1).INDEX_NAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: FEATURE_PREP(1).DOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 2
- name: FEATURE_PREP(1).CATTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 3
- name: FEATURE_PREP(1).CATDOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 4
- name: FEATURE_PREP(1).CATID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 5
- name: FEATURE_PREP(1).RESTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 6
- name: FEATURE_PREP(1).PREFERENCE
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 7
- name: FEATURE_PREP(2).INDEX_NAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: FEATURE_PREP(2).DOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 2
- name: FEATURE_PREP(2).RESTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 3
- name: FEATURE_PREP_NC.IDX_OWNER
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: FEATURE_PREP_NC.IDX_NAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 2
- name: FEATURE_PREP_NC.DOCTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 3
- name: FEATURE_PREP_NC.DOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 4
- name: FEATURE_PREP_NC.CATTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 5
- name: FEATURE_PREP_NC.CATDOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 6
- name: FEATURE_PREP_NC.CATID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 7
- name: FEATURE_PREP_NC.RESTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 8
- name: FEATURE_PREP_NC.PREFID
  dataType: NUMBER
  parameterMode: IN
  ordinalPosition: 9
- name: FEATURE_PREP_NC.TEMP_TABLE
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 10
- name: FI2TTAB.FI2TTAB
  dataType: VARCHAR2
  parameterMode: OUT
  ordinalPosition: 1
- name: FVSTAB.FVSTAB
  dataType: VARCHAR2
  parameterMode: OUT
  ordinalPosition: 1
- name: GET_SUGGESTIONS.MODEL_NAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: GET_SUGGESTIONS.DUR
  dataType: NUMBER
  parameterMode: IN
  ordinalPosition: 2
- name: ODM_DRPMODEL.P_MODNAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: ODM_GENMODEL.P_FVSTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: ODM_GENMODEL.P_SRTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 2
- name: ODM_GENMODEL.P_CLUSTER_NUM
  dataType: NUMBER
  parameterMode: IN
  ordinalPosition: 3
- name: ODM_GENMODEL.O_MODNAME
  dataType: VARCHAR2
  parameterMode: OUT
  ordinalPosition: 4
- name: ODMKTRAINSET.P_SRT
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: ODMKTRAINSET.P_CLUSTER_NUM
  dataType: NUMBER
  parameterMode: IN
  ordinalPosition: 2
- name: ODM_READKMEANMODEL.P_MODNAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: SVM_TRAIN.IDX_OWNER
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 1
- name: SVM_TRAIN.IDX_NAME
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 2
- name: SVM_TRAIN.DOCTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 3
- name: SVM_TRAIN.DOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 4
- name: SVM_TRAIN.CATTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 5
- name: SVM_TRAIN.CATDOCID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 6
- name: SVM_TRAIN.CATID
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 7
- name: SVM_TRAIN.RESTAB
  dataType: VARCHAR2
  parameterMode: IN
  ordinalPosition: 8
- name: SVM_TRAIN.PREFID
  dataType: NUMBER
  parameterMode: IN
  ordinalPosition: 9
routineDefinition: "PACKAGE drvodm AUTHID current_user AS TYPE CurType IS REF CURSOR;\n\
  /* type used for svm interface to odm containing training set */\nTYPE trainsamp\
  \ IS RECORD (\n  sequence_id NUMBER,\n  -- document id\n  attribute_id NUMBER,\n\
  \  -- feature id >=0\n  -- or -1 for rows that contain doc. assignment info\n  value\
  \ NUMBER -- feature weight\n  -- or catid for rows for doc. assignment info\n);\n\
  TYPE trainsamps IS TABLE OF trainsamp;\n/* type used for feature definition */\n\
  TYPE feature IS RECORD (\n  text varchar2(160),\n  -- feature text\n  type number(3),\n\
  \  -- feature type with 0:single token,\n  --\t\t     1:theme\n  --\t\t     9:stem\
  \ words\n  id number,\n  -- feature id\n  score number -- statistic feature score\
  \ which can be idf\n  --    if need to calculate idf for feature\n  --    weight\
  \ in documents or simply document\n  --    frequency.\n);\nTYPE features IS TABLE\
  \ OF feature;\nTYPE suggestion IS RECORD (\n  docid number,\n  -- document id\n\
  \  catid number,\n  -- suggested category id\n  scr number -- associate score between\
  \ doc and category\n);\nTYPE suggestions IS TABLE of suggestion;\nTYPE kmeanmodel_rec\
  \ IS RECORD (\n  id integer,\n  -- cluster id\n  parent number,\n  -- parent id\n\
  \  dispersion number,\n  -- coherencen of the cluster\n  attribute_name varchar2(30)\n\
  );\n-- attribute id\nTYPE kmeanmodel is table of kmeanmodel_rec;\n/* train SVM model\
  \ */\nPROCEDURE svm_train(\n  idx_owner varchar2,\n  idx_name varchar2,\n  doctab\
  \ varchar2,\n  docid varchar2,\n  cattab varchar2,\n  catdocid varchar2,\n  catid\
  \ varchar2,\n  restab varchar2,\n  prefid number\n);\n/* ----table function used\
  \ for ODM to extract feature from training set ----*/\n/* DESCRIPTION\n\n   The\
  \ result table is either created by users before calling this function or\n\n  \
  \ created in this program with the specified table name and under the current\n\n\
  \   user (if the specified table does not exist).\n\n   If user create the result\
  \ table (which can support table schema for\n\n   different users),\n\n   the restab\
  \ should have the following three columns with the exact column\n\n   names:\n\n\
  \tcat_id number\n\n\ttype number(3) not null\n\n\trule blob\n\n*/\nFUNCTION feature_prep(\n\
  \  index_name varchar2,\n  -- context index name on training document table.\n \
  \ docid varchar2,\n  -- document id column name in document table\n  cattab varchar2,\n\
  \  -- name of category table\n  catdocid varchar2,\n  -- document id column name\
  \ for category table\n  catid varchar2,\n  -- category id column name for category\
  \ table\n  restab varchar2,\n  -- result table to write the model\n  preference\
  \ varchar2 -- preference name\n) RETURN trainsamps PIPELINED;\n/* -- table function\
  \ used for ODM to get features for test set ----------*/\n/* DESCRIPTION\n\n   This\
  \ function is used in apply time. The <restab> is the result table\n\n   output\
  \ from calling feature preparation function based on training set.\n\n*/\nFUNCTION\
  \ feature_prep(\n  index_name varchar2,\n  -- context index name on training document\
  \ table.\n  docid varchar2,\n  -- document id column name in document table\n  restab\
  \ varchar2 -- table storing the feature definition\n) RETURN trainsamps PIPELINED;\n\
  /* ----------------------- for ODM to explain features ------------------*/\n/*\
  \ DESCRIPTION\n\n   The <restab> is the result table output from calling feature\
  \ preparation\n\n   function based on training set.\n\n*/\nFUNCTION feature_explain(\n\
  \  restab varchar2 -- table storing the feature definition\n) RETURN features PIPELINED;\n\
  /*--------------------------------------------------------------------------*/\n\
  /*                                                                          */\n\
  /*------------The following functions is internal functions  ---------------*/\n\
  /*                                                                          */\n\
  /*--------------------------------------------------------------------------*/\n\
  /* feature preparation table function without checking input parameter */\nFUNCTION\
  \ feature_prep_nc(\n  idx_owner varchar2,\n  idx_name varchar2,\n  doctab varchar2,\n\
  \  docid varchar2,\n  cattab varchar2,\n  catdocid varchar2,\n  catid varchar2,\n\
  \  restab varchar2,\n  prefid number,\n  temp_table varchar2\n) RETURN trainsamps\
  \ PIPELINED;\n/* start classify a document.Assume: The document feature vector has\
  \ been\n\n   generated */\nFUNCTION get_suggestions(model_name varchar2, dur number)\
  \ return suggestions PIPELINED;\n/* type used for ODM setup */\nTYPE settingdbrec_t\
  \ IS RECORD (\n  id NUMBER,\n  value VARCHAR2(128)\n);\nTYPE setting_t IS TABLE\
  \ of settingdbrec_t;\nFUNCTION odmtrainset return setting_t PIPELINED;\nFUNCTION\
  \ get_features RETURN trainsamps PIPELINED;\nPROCEDURE fvstab(fvstab OUT varchar2);\n\
  PROCEDURE fi2ttab(fi2ttab OUT varchar2);\nFUNCTION odmktrainset(p_srt in varchar2,\
  \ p_cluster_num in number) return setting_t PIPELINED;\n-- generate model\nPROCEDURE\
  \ odm_genmodel(\n  p_fvstab in varchar2,\n  p_srtab in varchar2,\n  p_cluster_num\
  \ in number,\n  o_modname OUT varchar2\n);\nFUNCTION odm_readkmeanmodel(p_modname\
  \ varchar2) return kmeanmodel PIPELINED;\n-- drop model\nPROCEDURE odm_drpmodel(p_modname\
  \ IN varchar2);\nEND drvodm;"
